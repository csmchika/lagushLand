let canvas,ctx,flag=!1,prevX=0,currX=0,prevY=0,currY=0,dot_flag=!1,x="black",y=10;function init(){canvas=document.getElementById("can"),ctx=canvas.getContext("2d"),w=canvas.width,h=canvas.height;let e=new Image;e.src="img/draw/drawing.png",e.onload=function(){ctx.drawImage(e,0,0)},canvas.addEventListener("mousemove",function(e){findxy("move",e)},!1),canvas.addEventListener("mousedown",function(e){findxy("down",e)},!1),canvas.addEventListener("mouseup",function(e){findxy("up",e)},!1),canvas.addEventListener("mouseout",function(e){findxy("out",e)},!1),canvas.addEventListener("touchmove",function(e){findxy("move",e)},!1),canvas.addEventListener("touchend",function(e){findxy("up",e)},!1),canvas.addEventListener("touched",function(e){findxy("up",e)},!1),canvas.addEventListener("touchstart",function(e){findxy("down",e)},!1)}function color(e){switch(e.id){case"green":x="#228B22";break;case"blue":x="#4884a8";break;case"yellow":x="#FFA500";break;case"orange":x="#e85409";break;case"black":x="black";break;case"zel":x="#132b07";break;case"white":x="white";break;case"brown":x="#381c08"}y="white"===x?14:10}function draw(){ctx.beginPath(),ctx.moveTo(prevX,prevY),ctx.lineTo(currX,currY),ctx.strokeStyle=x,ctx.lineWidth=y,ctx.stroke(),ctx.closePath()}function save(){return canvas.toDataURL()}function findxy(e,n){"down"===e&&(prevX=currX,prevY=currY,currX=n.clientX-canvas.offsetLeft,currY=n.clientY-canvas.offsetTop,flag=!0,(dot_flag=!0)&&(ctx.beginPath(),ctx.fillStyle=x,ctx.fillRect(currX,currY,2,2),ctx.closePath(),dot_flag=!1)),"up"!==e&&"out"!==e||(flag=!1),"move"===e&&flag&&(prevX=currX,prevY=currY,currX=n.clientX-canvas.offsetLeft,currY=n.clientY-canvas.offsetTop,draw())}